<!doctype html><html><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Thanks! Preparing your download…</title>
<script>
(async () => {
  const p = new URLSearchParams(location.search);
  const session_id = p.get('session_id');
  if(!session_id){ document.body.textContent='Missing session_id'; return; }
  const r = await fetch('/.netlify/functions/claim-download', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ sessionId: session_id })
  });
  if(!r.ok){ document.body.textContent='Could not verify payment.'; return; }
  const { downloadUrl } = await r.json();
  location.href = downloadUrl;
})();
</script>
</head><body>
  <h1>Payment received! Your download will start automatically…</h1>
  <p>If it doesn’t, check your email for the backup copy.</p>
  <p><a href="/">Back to Home</a></p>
</body></html>
