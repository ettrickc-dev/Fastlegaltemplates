<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Caregiver Services Agreement â€” Fast Legal Templates</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="max-w-6xl mx-auto p-6 flex items-center justify-between">
    <a href="/" class="text-sm text-gray-600">&larr; Home</a>
    <h1 class="text-2xl font-extrabold text-emerald-700">Caregiver Services Agreement</h1>
    <div></div>
  </header>

  <main class="max-w-6xl mx-auto p-6 grid lg:grid-cols-2 gap-6">
    <!-- LEFT: FORM -->
    <section class="bg-white border rounded-xl shadow p-5">
      <h2 class="text-xl font-bold mb-3">Step 1 â€” About You</h2>

      <label class="block text-sm font-medium mb-1">Your Email</label>
      <input id="buyerEmail" class="border rounded w-full p-2 mb-3" placeholder="you@example.com"/>

      <label class="block text-sm font-medium mb-1">Your Name</label>
      <input id="buyerName" class="border rounded w-full p-2 mb-4" placeholder="Your full name"/>

      <h2 class="text-xl font-bold mb-3">Step 2 â€” Parties & Basics</h2>

      <label class="block text-sm font-medium mb-1">Client (person receiving care)</label>
      <input id="clientName" class="border rounded w-full p-2 mb-3" placeholder="Client Full Name"/>

      <label class="block text-sm font-medium mb-1">Caregiver</label>
      <input id="caregiverName" class="border rounded w-full p-2 mb-3" placeholder="Caregiver Full Name"/>

      <label class="block text-sm font-medium mb-1">Arrangement Type</label>
      <select id="arrangementType" class="border rounded w-full p-2 mb-3">
        <option value="W-2 Employee">W-2 Employee</option>
        <option value="1099 Independent Contractor">1099 Independent Contractor</option>
      </select>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Start Date</label>
          <input type="date" id="startDate" class="border rounded w-full p-2 mb-3"/>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Care Location (city/state)</label>
          <input id="careLocation" class="border rounded w-full p-2 mb-3" placeholder="e.g., Scarsdale, NY"/>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Hourly Rate (or flat)</label>
          <input id="payRate" class="border rounded w-full p-2 mb-3" placeholder="$28/hour"/>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Pay Schedule</label>
          <input id="paySchedule" class="border rounded w-full p-2 mb-3" placeholder="weekly / biweekly / monthly"/>
        </div>
      </div>

      <label class="block text-sm font-medium mb-1">Typical Hours / Days</label>
      <textarea id="hoursSchedule" class="border rounded w-full p-2 mb-4" rows="2" placeholder="e.g., Monâ€“Fri, 9amâ€“5pm; occasional weekends"></textarea>

      <!-- ðŸ”¥ NEW (ADDED, not replacing): Service Categories -->
      <h2 class="text-xl font-bold mb-3">Step 3 â€” Service Categories & Details</h2>
      <p class="text-sm text-gray-600 mb-3">Choose what the Caregiver will do. If you select a box, describe the tasks.</p>

      <div class="space-y-3">
        <!-- Personal Care -->
        <label class="flex items-start gap-2">
          <input type="checkbox" id="svcPersonal" class="mt-1"/>
          <span><strong>Personal Care</strong> (bathing, grooming, dressing, toileting, mobility assistance)</span>
        </label>
        <textarea id="svcPersonalDetails" class="border rounded w-full p-2" rows="2" placeholder="Describe any limits or specifics (e.g., transfer belt, bathing schedule)"></textarea>

        <!-- Medical/Health Support -->
        <label class="flex items-start gap-2 mt-3">
          <input type="checkbox" id="svcMedical" class="mt-1"/>
          <span><strong>Medical/Health Support</strong> (medication reminders/administration, coordinating appointments, monitoring vital signs â€” specify limits)</span>
        </label>
        <textarea id="svcMedicalDetails" class="border rounded w-full p-2" rows="2" placeholder="e.g., reminders only (no injections); record BP daily; accompany to cardiology visits"></textarea>

        <!-- Household Tasks -->
        <label class="flex items-start gap-2 mt-3">
          <input type="checkbox" id="svcHousehold" class="mt-1"/>
          <span><strong>Household Tasks</strong> (light housekeeping, laundry, dishes, meal planning/prep, grocery errands)</span>
        </label>
        <textarea id="svcHouseholdDetails" class="border rounded w-full p-2" rows="2" placeholder="e.g., vacuum weekly; laundry 1x/week; meal-prep low-salt; shop with client card"></textarea>

        <!-- Companionship -->
        <label class="flex items-start gap-2 mt-3">
          <input type="checkbox" id="svcCompanionship" class="mt-1"/>
          <span><strong>Companionship</strong> (social interaction, reading, hobbies, transportation to outings)</span>
        </label>
        <textarea id="svcCompanionshipDetails" class="border rounded w-full p-2" rows="2" placeholder="e.g., daily walk 20 min; read newspaper; drive to senior center Fridays"></textarea>

        <!-- Other -->
        <label class="flex items-start gap-2 mt-3">
          <input type="checkbox" id="svcOther" class="mt-1"/>
          <span><strong>Other services</strong> (add anything else)</span>
        </label>
        <textarea id="svcOtherDetails" class="border rounded w-full p-2" rows="2" placeholder="Describe any additional duties not listed above"></textarea>
      </div>

      <!-- ðŸ”¥ NEW (ADDED): Reimbursement -->
      <h2 class="text-xl font-bold mt-6 mb-3">Step 4 â€” Reimbursement Policy</h2>
      <label class="block text-sm font-medium mb-1">Will the Caregiver be reimbursed for pre-approved, necessary expenses incurred on behalf of the Client?</label>
      <select id="reimburseAllowed" class="border rounded w-full p-2 mb-3">
        <option value="No">No</option>
        <option value="Yes">Yes</option>
      </select>

      <div id="reimburseBox" class="hidden">
        <p class="text-sm text-gray-600 mb-2">If Yes, select required documentation for reimbursement:</p>
        <div class="grid sm:grid-cols-2 gap-2 mb-2">
          <label class="flex items-center gap-2"><input type="checkbox" class="rbDoc" value="Original receipts"/> Original receipts</label>
          <label class="flex items-center gap-2"><input type="checkbox" class="rbDoc" value="Mileage log"/> Mileage log</label>
          <label class="flex items-center gap-2"><input type="checkbox" class="rbDoc" value="Itemized invoice"/> Itemized invoice</label>
          <label class="flex items-center gap-2"><input type="checkbox" class="rbDoc" value="Written pre-approval"/> Written pre-approval</label>
        </div>
        <label class="block text-sm font-medium mb-1">Other documentation (optional)</label>
        <input id="rbOtherText" class="border rounded w-full p-2 mb-3" placeholder="e.g., photo of purchase, delivery confirmation"/>
      </div>

      <!-- ðŸ”¥ NEW (ADDED): Insurance -->
      <h2 class="text-xl font-bold mt-6 mb-3">Step 5 â€” Insurance Requirement</h2>
      <label class="block text-sm font-medium mb-1">Is the Caregiver required to maintain insurance?</label>
      <select id="insuranceRequired" class="border rounded w-full p-2 mb-3">
        <option value="No">No</option>
        <option value="Yes">Yes</option>
      </select>

      <div id="insuranceBox" class="hidden">
        <div class="grid sm:grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium mb-1">Professional Liability (min coverage)</label>
            <input id="insProf" class="border rounded w-full p-2 mb-3" placeholder="$1,000,000 per claim"/>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">General Liability (min coverage)</label>
            <input id="insGen" class="border rounded w-full p-2 mb-3" placeholder="$1,000,000 per occurrence"/>
          </div>
        </div>
      </div>

      <h2 class="text-xl font-bold mt-6 mb-3">Step 6 â€” Notes (optional)</h2>
      <textarea id="specialNotes" class="border rounded w-full p-2 mb-4" rows="3" placeholder="Any special instructions or limits to include verbatim in the agreement"></textarea>

      <hr class="my-5"/>

      <h2 class="text-xl font-bold mb-3">Step 7 â€” Checkout</h2>
      <button id="startCheckout" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded">Buy Now</button>
      <p class="text-xs text-gray-500 mt-2">Stripe checkout opens with your caregiver template price.</p>
    </section>

    <!-- RIGHT: PREVIEW -->
    <section class="bg-white border rounded-xl shadow p-5 relative">
      <h2 class="text-xl font-bold mb-3">Preview (Updates as you type)</h2>
      <div class="relative min-h-[420px]">
        <pre id="preview" class="text-sm whitespace-pre-wrap leading-5"></pre>
        <div class="pointer-events-none select-none absolute inset-0 flex items-center justify-center text-6xl font-black text-emerald-500/10">
          UNPAID DRAFT
        </div>
      </div>
    </section>
  </main>

  <script>
  // === CONFIG ===
  const PRICE_ID = "price_1SKKSnHcizSl783nL20brMXo"; // Caregiver price you provided

  // === Show/hide groups ===
  const reimburseAllowed = document.getElementById('reimburseAllowed');
  const reimburseBox = document.getElementById('reimburseBox');
  const insuranceRequired = document.getElementById('insuranceRequired');
  const insuranceBox = document.getElementById('insuranceBox');

  function toggleBoxes() {
    reimburseBox.classList.toggle('hidden', reimburseAllowed.value !== 'Yes');
    insuranceBox.classList.toggle('hidden', insuranceRequired.value !== 'Yes');
  }

  reimburseAllowed.addEventListener('change', () => { toggleBoxes(); refreshPreview(); });
  insuranceRequired.addEventListener('change', () => { toggleBoxes(); refreshPreview(); });

  // === Build final content for preview & draft save ===
  function buildDraftContent() {
    const buyerName = document.getElementById('buyerName').value.trim();
    const clientName = document.getElementById('clientName').value.trim();
    const caregiverName = document.getElementById('caregiverName').value.trim();
    const arrangementType = document.getElementById('arrangementType').value;
    const startDate = document.getElementById('startDate').value;
    const careLocation = document.getElementById('careLocation').value.trim();
    const payRate = document.getElementById('payRate').value.trim();
    const paySchedule = document.getElementById('paySchedule').value.trim();
    const hoursSchedule = document.getElementById('hoursSchedule').value.trim();
    const specialNotes = document.getElementById('specialNotes').value.trim();

    // Services
    const svc = [];
    if (document.getElementById('svcPersonal').checked) {
      svc.push({label: "Personal Care", details: document.getElementById('svcPersonalDetails').value.trim()});
    }
    if (document.getElementById('svcMedical').checked) {
      svc.push({label: "Medical/Health Support", details: document.getElementById('svcMedicalDetails').value.trim()});
    }
    if (document.getElementById('svcHousehold').checked) {
      svc.push({label: "Household Tasks", details: document.getElementById('svcHouseholdDetails').value.trim()});
    }
    if (document.getElementById('svcCompanionship').checked) {
      svc.push({label: "Companionship", details: document.getElementById('svcCompanionshipDetails').value.trim()});
    }
    if (document.getElementById('svcOther').checked) {
      svc.push({label: "Other Services", details: document.getElementById('svcOtherDetails').value.trim()});
    }

    // Reimbursement
    const reimb = reimburseAllowed.value;
    let rbDocs = [];
    document.querySelectorAll('.rbDoc:checked').forEach(cb => rbDocs.push(cb.value));
    const rbOther = document.getElementById('rbOtherText').value.trim();

    // Insurance
    const insReq = insuranceRequired.value;
    const insProf = document.getElementById('insProf')?.value.trim() || "";
    const insGen  = document.getElementById('insGen')?.value.trim() || "";

    const svcLines = svc.length === 0
      ? "None selected."
      : svc.map(s => `â€¢ ${s.label}${s.details ? ` â€” ${s.details}` : ""}`).join('\n');

    const reimbBlock = reimb === 'Yes'
      ? `Reimbursement: Allowed for pre-approved, necessary expenses incurred on behalf of the Client.
Required documentation: ${rbDocs.length ? rbDocs.join(', ') : "as requested"}${rbOther ? `; Other: ${rbOther}` : ""}.`
      : `Reimbursement: Not allowed without prior written approval.`;

    const insuranceBlock = insReq === 'Yes'
      ? `Caregiver Insurance: Required. Minimum coverage: Professional Liability ${insProf || "(specify)"}; General Liability ${insGen || "(specify)"}.`
      : `Caregiver Insurance: Not required under this Agreement (unless required by law).`;

    // Mandatory clauses
    const hipaa = `Confidentiality and Privacy (HIPAA Compliance)
The Caregiver acknowledges access to private, confidential, and protected health information (PHI) relating to the Client and agrees:
1) To maintain the strict confidentiality of all Client information;
2) Not to disclose such information to third parties without the Client's or legal representative's explicit written consent, unless required by law; and
3) To comply with all applicable state and federal privacy laws, including HIPAA, to the extent applicable.`;

    const indemn = `Indemnification
The Caregiver agrees to indemnify and hold harmless the Client from and against any and all claims, losses, damages, or liability arising from the Caregiverâ€™s negligence, gross misconduct, or intentional acts.`;

    const content = `
CAREGIVER SERVICES AGREEMENT

Client: ${clientName || "[Client Name]"}
Caregiver: ${caregiverName || "[Caregiver Name]"}
Arrangement Type: ${arrangementType}
Start Date: ${startDate || "[Start Date]"}
Care Location: ${careLocation || "[City/State]"}

Compensation
Rate: ${payRate || "[Rate]"}
Pay Schedule: ${paySchedule || "[Schedule]"}
Typical Hours/Days: ${hoursSchedule || "[e.g., Monâ€“Fri, 9amâ€“5pm]"}

Scope of Services
${svcLines}

${reimbBlock}

${insuranceBlock}

${hipaa}

${indemn}

Special Notes (if any)
${specialNotes || "(none)"}

Signatures
Client: ____________________________   Date: _____________
Caregiver: _________________________   Date: _____________
`.trim();

    return { content, product: "Caregiver Services Agreement", name: buyerName || caregiverName || clientName || "Customer" };
  }

  // === Live preview (updates while you type) ===
  function refreshPreview() {
    const { content } = buildDraftContent();
    document.getElementById('preview').textContent = content;
  }

  // Attach live listeners to all inputs/textareas/selects/checkboxes
  function wireLivePreview() {
    const inputs = document.querySelectorAll('input, textarea, select');
    inputs.forEach(el => {
      const evt = (el.type === 'checkbox' || el.tagName === 'SELECT') ? 'change' : 'input';
      el.addEventListener(evt, refreshPreview);
    });
  }

  // === Save draft to Netlify function ===
  async function saveDraft() {
    const email = document.getElementById('buyerEmail').value.trim();
    const { content, product, name } = buildDraftContent();

    const r = await fetch('/.netlify/functions/save-draft', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, name, product, content })
    });
    if (!r.ok) throw new Error('save-draft failed');
    return r.json(); // { draftId }
  }

  // === Start Stripe checkout ===
  document.getElementById('startCheckout').addEventListener('click', async () => {
    try {
      const email = document.getElementById('buyerEmail').value.trim();
      if (!email) { alert('Please enter your email.'); return; }

      const { draftId } = await saveDraft();

      const r = await fetch('/.netlify/functions/create-checkout', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({
          draftId,
          email,
          priceId: PRICE_ID,
          successPath: '/caregiver/success.html'
        })
      });
      if (!r.ok) {
        const t = await r.text();
        console.error('create-checkout failed:', t);
        alert('Problem starting checkout.');
        return;
      }
      const { url } = await r.json();
      location.href = url;
    } catch (e) {
      console.error(e);
      alert('There was a problem. Please check the required fields.');
    }
  });

  // init
  toggleBoxes();
  wireLivePreview();
  refreshPreview(); // show placeholders immediately
  </script>
</body>
</html>


</script>
</body></html>

